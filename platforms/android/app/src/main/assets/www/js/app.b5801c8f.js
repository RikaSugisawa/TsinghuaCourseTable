(function(t){function e(e){for(var a,i,o=e[0],d=e[1],c=e[2],u=0,m=[];u<o.length;u++)i=o[u],s[i]&&m.push(s[i][0]),s[i]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(t[a]=d[a]);l&&l(e);while(m.length)m.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,o=1;o<n.length;o++){var d=n[o];0!==s[d]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},s={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],d=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var l=d;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1:function(t,e){},"1b88":function(t,e,n){},"27f0":function(t,e,n){"use strict";var a=n("650c"),s=n.n(a);s.a},"56d7":function(t,e,n){"use strict";n.r(e);var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],i=n("2877"),o={},d=Object(i["a"])(o,s,r,!1,null,null,null),c=d.exports,l=n("8c4f"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login"},[n("form",{staticClass:"md-layout"},[n("md-card",{staticClass:"md-card-login"},[n("md-card-header",{staticClass:"md-title md-centered md-alignment-center"},[t._v("\n                Login\n            ")]),n("md-field",[n("label",{attrs:{for:"username"}},[t._v("Username")]),n("md-input",{attrs:{name:"username",id:"username",disabled:t.sending},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),n("md-field",[n("label",{attrs:{for:"password"}},[t._v("Password")]),n("md-input",{attrs:{name:"password",id:"password",type:"password",disabled:t.sending},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),n("md-button",{staticClass:"md-primary",attrs:{disabled:t.sending},on:{click:t.submit}},[t._v("Login")])],1)],1),n("md-dialog-alert",{attrs:{"md-active":t.myAlert,"md-content":t.alertInfo,"md-confirm-text":"OK"},on:{"update:mdActive":function(e){t.myAlert=e},"update:md-active":function(e){t.myAlert=e}}})],1)},m=[],f=n("43f9"),h=n.n(f);n("51de"),n("0759");a["default"].use(h.a);var g={name:"login",data(){return{form:{username:"",password:""},sending:!1,myAlert:!1,alertInfo:null}},methods:{async submit(){this.sending=!0;try{await this.Login(this.form.username,this.form.password),location.hash="#/table"}catch(t){this.myAlert=!0,this.alertInfo=t}finally{this.sending=!1}},async Login(t,e){return new Promise(function(n,a){cordova.plugins.TsinghuaUtils.login(t,e,n,t=>a(new Error(t)))})}}},p=g,v=(n("27f0"),Object(i["a"])(p,u,m,!1,null,"53e516a6",null)),D=v.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"table"},[n("div",{staticStyle:{height:"0",overflow:"hidden"}},[n("md-datepicker",{ref:"datepicker",attrs:{"md-immediately":""},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}})],1),n("md-toolbar",{staticClass:"md-accent",attrs:{"md-elevation":"0"}},[n("div",{staticClass:"md-title md-toolbar-section-start"},[t._v("\n            "+t._s(t.selectedDate.getFullYear())+"/"+t._s(t.selectedDate.getMonth()+1)+"\n        ")]),n("div",{staticClass:"md-toolbar-section-end"},[n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.selectedDate=new Date(t.selectedDate.setDate(t.selectedDate.getDate()-7))}}},[n("font-awesome-icon",{attrs:{icon:"chevron-left"}})],1),n("md-button",{staticClass:"md-icon-button",on:{click:function(e){t.selectedDate=new Date(t.selectedDate.setDate(t.selectedDate.getDate()+7))}}},[n("font-awesome-icon",{attrs:{icon:"chevron-right"}})],1),n("md-button",{staticClass:"md-icon-button",on:{click:t.showCalendar}},[n("font-awesome-icon",{attrs:{icon:"calendar-alt"}})],1)],1)]),n("md-card",{staticClass:"date-container md-accent"},t._l(t.week,function(e,a){return n("span",{key:"title"+e.getDate(),staticClass:"md-title date"},[n("md-button",{staticClass:"md-icon-button ",class:{"md-primary":e.getDate()===t.selectedDate.getDate(),"md-raised":e.getDate()===t.selectedDate.getDate()},on:{click:function(n){t.selectedDate=e}}},[t._v("\n            "+t._s(e.getDate())+"\n        ")])],1)}),0),n("div",{staticClass:"date-container event-container"},[-1===t.cachedDate?n("div",{staticClass:"day-container"},[n("md-progress-spinner",{staticClass:"spinner",attrs:{"md-mode":"indeterminate"}})],1):t.events.length>0?t._l(t.week,function(e,a){return n("div",{key:"day"+a,staticClass:"day-container"},t._l(t.eventsInDay(e),function(e,s){return n("div",{staticClass:"event-div",style:{height:100*e.Duration+"%",top:100*e.BeginFloat+"%"}},[n("md-card",{staticClass:"md-primary event-card",attrs:{"md-with-hover":""},nativeOn:{click:function(e){return t.eventClick(a,s)}}},[n("div",{staticClass:"small"},[t._v("\n                        "+t._s(e.Content)+"@"+t._s(e.Location)+"\n                    ")])]),n("md-menu",{ref:"menu_"+a+"_"+s,refInFor:!0,attrs:{mdActive:!1}},[n("md-menu-content",[n("md-menu-item",[t._v(t._s(e.Content))]),n("md-menu-item",[t._v("From "+t._s(e.obj.kssj))]),n("md-menu-item",[t._v("To "+t._s(e.obj.jssj))]),n("md-menu-item",[t._v("At "+t._s(e.Location))])],1)],1)],1)}),0)}):n("div",{staticClass:"day-container"},[n("md-empty-state",{attrs:{"md-rounded":"","md-label":"Nothing here.","md-description":"The data may be too new to be added.Or just no events."}},[n("md-button",{staticClass:"md-primary md-raised",on:{click:t.showCalendar}},[t._v("Selecet a proper date")])],1)],1)],2)],1)},w=[];class y{constructor(t){this.Location=t.dd,this.Content=t.nr,this.Date=new Date(t.nq),this.BeginTime=new Date(t.nq+"T"+t.kssj+"Z"),this.EndTime=new Date(t.nq+"T"+t.jssj+"Z"),this.obj=t}static HoursInDay(t){return t.getTime()/1e3/60%1440/60}get BeginFloat(){return(y.HoursInDay(this.BeginTime)-8)/14}get EndFloat(){return(y.HoursInDay(this.EndTime)-8)/14}get Duration(){return this.EndFloat-this.BeginFloat}}var _={name:"event-table",data(){return{events:[],selectedDate:new Date,cachedDate:null}},computed:{week(){let t=[];for(let e=0;e<7;e++){let n=new Date(this.beginDate);n.setDate(n.getDate()+e),t.push(n)}return t},beginDate(){let t=new Date(this.selectedDate);return t.setDate(t.getDate()-(this.selectedDate.getDay()+6)%7),t}},methods:{eventsInDay(t){let e=[];for(let n=0;n<this.events.length;n++)`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`===this.events[n].nq&&e.push(new y(this.events[n]));return e},showCalendar(){this.$refs.datepicker.toggleDialog()},eventClick(t,e){setTimeout(this.$refs[`menu_${t}_${e}`][0].toggleContent,100)},async getCalendar(t,e){return new Promise(function(n,a){cordova.plugins.TsinghuaUtils.getCalendar(t,e,n,t=>a(new Error(t)))})}},watch:{async beginDate(){if(null===this.cachedDate||this.cachedDate.toString()!==this.beginDate.toString()&&-1!==this.cachedDate)try{this.cachedDate=-1,this.events=[];let e=new Date(this.beginDate);e.setDate(e.getDate()+6);const n=`${this.beginDate.getFullYear()}${(this.beginDate.getMonth()+1).toString().padStart(2,"0")}${this.beginDate.getDate().toString().padStart(2,"0")}`,a=`${e.getFullYear()}${(e.getMonth()+1).toString().padStart(2,"0")}${e.getDate().toString().padStart(2,"0")}`,s=await this.getCalendar(n,a);this.events=JSON.parse(s),this.cachedDate=this.beginDate}catch(t){throw this.cachedDate=null,t}}},async mounted(){}},C=_,k=(n("d400"),Object(i["a"])(C,b,w,!1,null,null,null)),S=k.exports;a["default"].use(l["a"]);var j=new l["a"]({routes:[{path:"/table",component:S},{path:"/",component:D}]}),$=n("28dd"),O=n("ecee"),T=n("c074"),x=n("faaa"),F=n("ad3d");O["c"].add(T["a"]),O["c"].add(x["a"]),a["default"].component("font-awesome-icon",F["a"]),a["default"].use(h.a),a["default"].use($["a"]),a["default"].config.productionTip=!1,new a["default"]({router:j,render:function(t){return t(c)}}).$mount("#app")},"650c":function(t,e,n){},d400:function(t,e,n){"use strict";var a=n("1b88"),s=n.n(a);s.a}});
//# sourceMappingURL=app.6a399152.js.map